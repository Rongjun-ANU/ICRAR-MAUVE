/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:193: RuntimeWarning: divide by zero encountered in divide
  BD = HA6562_FLUX / HB4861_FLUX
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:193: RuntimeWarning: invalid value encountered in divide
  BD = HA6562_FLUX / HB4861_FLUX
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:254: RuntimeWarning: divide by zero encountered in divide
  y = np.log10(NII6583_FLUX_corr / (SII6716_FLUX_corr + SII6730_FLUX_corr)) + 0.264*np.log10(NII6583_FLUX_corr / HA6562_FLUX_corr)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:254: RuntimeWarning: invalid value encountered in divide
  y = np.log10(NII6583_FLUX_corr / (SII6716_FLUX_corr + SII6730_FLUX_corr)) + 0.264*np.log10(NII6583_FLUX_corr / HA6562_FLUX_corr)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:254: RuntimeWarning: divide by zero encountered in log10
  y = np.log10(NII6583_FLUX_corr / (SII6716_FLUX_corr + SII6730_FLUX_corr)) + 0.264*np.log10(NII6583_FLUX_corr / HA6562_FLUX_corr)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:265: RuntimeWarning: divide by zero encountered in divide
  N2 = NII_scaled / HB4861_FLUX_corr   # N2 = I([N II]λ6548 + λ6584)/I(Hβ)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:265: RuntimeWarning: invalid value encountered in divide
  N2 = NII_scaled / HB4861_FLUX_corr   # N2 = I([N II]λ6548 + λ6584)/I(Hβ)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:266: RuntimeWarning: divide by zero encountered in divide
  S2 = (SII6716_FLUX_corr + SII6730_FLUX_corr) / HB4861_FLUX_corr  # S2 = I([S II]λ6717 + λ6731)/I(Hβ)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:266: RuntimeWarning: invalid value encountered in divide
  S2 = (SII6716_FLUX_corr + SII6730_FLUX_corr) / HB4861_FLUX_corr  # S2 = I([S II]λ6717 + λ6731)/I(Hβ)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:267: RuntimeWarning: divide by zero encountered in divide
  R3 = OIII_scaled / HB4861_FLUX_corr  # R3 = I([O III]λ4959 + λ5007)/I(Hβ) (same value as R2 in this case)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:267: RuntimeWarning: invalid value encountered in divide
  R3 = OIII_scaled / HB4861_FLUX_corr  # R3 = I([O III]λ4959 + λ5007)/I(Hβ) (same value as R2 in this case)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:269: RuntimeWarning: divide by zero encountered in divide
  log_R3_S2 = np.log10(R3/S2)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:269: RuntimeWarning: invalid value encountered in divide
  log_R3_S2 = np.log10(R3/S2)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:269: RuntimeWarning: divide by zero encountered in log10
  log_R3_S2 = np.log10(R3/S2)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:270: RuntimeWarning: divide by zero encountered in log10
  log_N2 = np.log10(N2)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:271: RuntimeWarning: divide by zero encountered in log10
  log_S2 = np.log10(S2)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:294: RuntimeWarning: invalid value encountered in add
  O_H_PG16[upper_mask] = (a1_upper + a2_upper * log_R3_S2[upper_mask] + a3_upper * log_N2[upper_mask] +
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:297: RuntimeWarning: invalid value encountered in add
  O_H_PG16[lower_mask] = (a1_lower + a2_lower * log_R3_S2[lower_mask] + a3_lower * log_N2[lower_mask] +
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:298: RuntimeWarning: invalid value encountered in add
  (a4_lower + a5_lower * log_R3_S2[lower_mask] + a6_lower * log_N2[lower_mask]) * log_S2[lower_mask])
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:320: RuntimeWarning: divide by zero encountered in divide
  oiii_hb = oiii5006_flux / hb4861_flux
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:320: RuntimeWarning: invalid value encountered in divide
  oiii_hb = oiii5006_flux / hb4861_flux
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:321: RuntimeWarning: divide by zero encountered in divide
  nii_ha = nii6583_flux / ha6562_flux
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:321: RuntimeWarning: invalid value encountered in divide
  nii_ha = nii6583_flux / ha6562_flux
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:322: RuntimeWarning: divide by zero encountered in divide
  o3n2_ratio = np.log10(oiii_hb / nii_ha)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:322: RuntimeWarning: invalid value encountered in divide
  o3n2_ratio = np.log10(oiii_hb / nii_ha)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:322: RuntimeWarning: divide by zero encountered in log10
  o3n2_ratio = np.log10(oiii_hb / nii_ha)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:350: RuntimeWarning: divide by zero encountered in divide
  n2_ratio = np.log10(nii6583_flux / ha6562_flux)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:350: RuntimeWarning: invalid value encountered in divide
  n2_ratio = np.log10(nii6583_flux / ha6562_flux)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:350: RuntimeWarning: divide by zero encountered in log10
  n2_ratio = np.log10(nii6583_flux / ha6562_flux)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:379: RuntimeWarning: divide by zero encountered in divide
  oiii_hb = oiii5006_flux / hb4861_flux
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:379: RuntimeWarning: invalid value encountered in divide
  oiii_hb = oiii5006_flux / hb4861_flux
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:380: RuntimeWarning: divide by zero encountered in divide
  nii_ha = nii6583_flux / ha6562_flux
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:380: RuntimeWarning: invalid value encountered in divide
  nii_ha = nii6583_flux / ha6562_flux
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:381: RuntimeWarning: divide by zero encountered in divide
  o3n2_ratio = np.log10(oiii_hb / nii_ha)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:381: RuntimeWarning: invalid value encountered in divide
  o3n2_ratio = np.log10(oiii_hb / nii_ha)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:381: RuntimeWarning: divide by zero encountered in log10
  o3n2_ratio = np.log10(oiii_hb / nii_ha)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:409: RuntimeWarning: divide by zero encountered in divide
  n2_ratio = np.log10(nii6583_flux / ha6562_flux)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:409: RuntimeWarning: invalid value encountered in divide
  n2_ratio = np.log10(nii6583_flux / ha6562_flux)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:409: RuntimeWarning: divide by zero encountered in log10
  n2_ratio = np.log10(nii6583_flux / ha6562_flux)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:433: RuntimeWarning: divide by zero encountered in divide
  oiii_hb = oiii5006_flux / hb4861_flux
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:433: RuntimeWarning: invalid value encountered in divide
  oiii_hb = oiii5006_flux / hb4861_flux
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:434: RuntimeWarning: divide by zero encountered in divide
  nii_ha = nii6583_flux / ha6562_flux
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:434: RuntimeWarning: invalid value encountered in divide
  nii_ha = nii6583_flux / ha6562_flux
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:435: RuntimeWarning: divide by zero encountered in divide
  o3n2_ratio = np.log10(oiii_hb / nii_ha)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:435: RuntimeWarning: invalid value encountered in divide
  o3n2_ratio = np.log10(oiii_hb / nii_ha)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:435: RuntimeWarning: divide by zero encountered in log10
  o3n2_ratio = np.log10(oiii_hb / nii_ha)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:492: RuntimeWarning: divide by zero encountered in divide
  oiii_hb = oiii5006_flux / hb4861_flux
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:492: RuntimeWarning: invalid value encountered in divide
  oiii_hb = oiii5006_flux / hb4861_flux
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:494: RuntimeWarning: divide by zero encountered in divide
  o3s2_ratio = np.log10(oiii_hb / (sii_total / hb4861_flux))  # ([OIII]/Hβ) / ([SII]/Hβ)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:494: RuntimeWarning: invalid value encountered in divide
  o3s2_ratio = np.log10(oiii_hb / (sii_total / hb4861_flux))  # ([OIII]/Hβ) / ([SII]/Hβ)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:494: RuntimeWarning: divide by zero encountered in log10
  o3s2_ratio = np.log10(oiii_hb / (sii_total / hb4861_flux))  # ([OIII]/Hβ) / ([SII]/Hβ)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:1010: RuntimeWarning: divide by zero encountered in divide
  logN2  = np.log10(NII6583_FLUX_corr / HA6562_FLUX_corr)        # [N II]/Hα
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:1010: RuntimeWarning: invalid value encountered in divide
  logN2  = np.log10(NII6583_FLUX_corr / HA6562_FLUX_corr)        # [N II]/Hα
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:1010: RuntimeWarning: divide by zero encountered in log10
  logN2  = np.log10(NII6583_FLUX_corr / HA6562_FLUX_corr)        # [N II]/Hα
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:1011: RuntimeWarning: divide by zero encountered in divide
  logS2  = np.log10((SII6716_FLUX_corr+SII6730_FLUX_corr) / HA6562_FLUX_corr)   # Σ[S II]/Hα
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:1011: RuntimeWarning: invalid value encountered in divide
  logS2  = np.log10((SII6716_FLUX_corr+SII6730_FLUX_corr) / HA6562_FLUX_corr)   # Σ[S II]/Hα
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:1011: RuntimeWarning: divide by zero encountered in log10
  logS2  = np.log10((SII6716_FLUX_corr+SII6730_FLUX_corr) / HA6562_FLUX_corr)   # Σ[S II]/Hα
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:1012: RuntimeWarning: divide by zero encountered in divide
  logO3  = np.log10(OIII5006_FLUX_corr / HB4861_FLUX_corr)       # [O III]/Hβ
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:1012: RuntimeWarning: invalid value encountered in divide
  logO3  = np.log10(OIII5006_FLUX_corr / HB4861_FLUX_corr)       # [O III]/Hβ
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:1012: RuntimeWarning: divide by zero encountered in log10
  logO3  = np.log10(OIII5006_FLUX_corr / HB4861_FLUX_corr)       # [O III]/Hβ
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:1097: RuntimeWarning: invalid value encountered in subtract
  mask_N2_left, mask_S2_left = apply_bpt_masks(logN2=logN2-logN2_err, logS2=logS2-logS2_err, logO3=logO3)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:1098: RuntimeWarning: invalid value encountered in add
  mask_N2_right, mask_S2_right = apply_bpt_masks(logN2=logN2+logN2_err, logS2=logS2+logS2_err, logO3=logO3)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:1099: RuntimeWarning: invalid value encountered in subtract
  mask_N2_down, mask_S2_down = apply_bpt_masks(logN2=logN2, logS2=logS2, logO3=logO3-logO3_err)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:1100: RuntimeWarning: invalid value encountered in add
  mask_N2_up, mask_S2_up = apply_bpt_masks(logN2=logN2, logS2=logS2, logO3=logO3+logO3_err)
Reading gas-line FITS ➜ NGC4330_gas_BIN_maps.fits
File not found: NGC4330_KIN_maps_extended.fits
Combined C20 metallicity: median = 8.710, range = (7.809, 9.175)
Combined C20 method usage: O3N2=108812, N2=22124, O3S2=901, S2=2106, RS32=0, R3=4538
Combined C20 total: Selected O3N2-C20 with error 0.100
Available methods: [('O3N2-C20', np.float64(8.589459198075355), 0.1), ('O3S2-C20', np.float64(8.658714922405327), 0.15), ('RS32-C20', np.float64(8.668753525463146), 0.2), ('R3-C20', np.float64(8.54862993179753), 0.25), ('N2-C20', np.float64(8.484106721756207), 0.12), ('S2-C20', np.float64(8.579817139554462), 0.18)]
Combined C20 total: Selected O3N2-C20 with error 0.100
Available methods: [('O3N2-C20', np.float64(8.515646837328353), 0.1), ('O3S2-C20', np.float64(8.698303820004007), 0.15), ('RS32-C20', np.float64(8.688005604788499), 0.2), ('R3-C20', np.float64(8.603376800762714), 0.25), ('N2-C20', np.float64(8.481480130497742), 0.12), ('S2-C20', np.float64(8.57440791588282), 0.18)]
Extended file written ➜ /Users/Igniz/Desktop/ICRAR/extended/NGC4330_gas_BIN_maps_extended.fits
--------------------------------------------------------------
Total non-nan spaxels: 157381
Number of pixels with Halpha not detected: 67769
Number of pixels with Halpha detected, Hbeta not detected: 34329
Number of pixels with Halpha detected, Hbeta detected, NII not detected, OIII not detected and unclassified: 476
Number of pixels with Halpha detected, Hbeta detected, NII not detected, OIII detected and unclassified: 9
Number of pixels with Halpha detected, Hbeta detected, NII detected, OIII not detected and unclassified: 179
Number of pixels with Halpha detected, Hbeta detected, NII detected, OIII detected and unclassified: 122
Number of pixels with Halpha detected, Hbeta detected, SII not detected, OIII not detected and unclassified: 514
Number of pixels with Halpha detected, Hbeta detected, SII not detected, OIII detected and unclassified: 18
Number of pixels with Halpha detected, Hbeta detected, SII detected, OIII not detected and unclassified: 141
Number of pixels with Halpha detected, Hbeta detected, SII detected, OIII detected and unclassified: 113
--------------------------------------------------------------
Total corrected Halpha luminosity: 4.04e+40 erg/s
Total corrected Halpha luminosity from SF region: 3.84e+40 erg/s
Total Halpha SFR: 0.20 M☉/yr or in log10 scale: -0.70 log(M☉/yr)
Total Halpha SFR from SF region: 0.19 M☉/yr or in log10 scale: -0.72 log(M☉/yr)
--------------------------------------------------------------
[O/H] D16 SF: Total metallicity in SF region:  8.434185386934892
[O/H] PG16 SF: Total metallicity in SF region:  8.403806524039487
[O/H] O3N2-M13 SF: Total metallicity in SF region:  8.523691078124
[O/H] N2-M13 SF: Total metallicity in SF region:  8.505193263628419
[O/H] O3N2-PP04 SF: Total metallicity in SF region:  8.716080116820935
[O/H] N2-PP04 SF: Total metallicity in SF region:  8.615287761346426
[O/H] O3N2-C20 SF: Total metallicity in SF region:  8.73871321159816
[O/H] O3S2-C20 SF: Total metallicity in SF region:  8.86021272216451
[O/H] RS32-C20 SF: Total metallicity in SF region:  8.702057980618218
[O/H] R3-C20 SF: Total metallicity in SF region:  8.741957295749037
[O/H] N2-C20 SF: Total metallicity in SF region:  8.673439156128385
[O/H] S2-C20 SF: Total metallicity in SF region:  nan
[O/H] Combined-C20 SF: Total metallicity in SF region:  8.589459198075355
--------------------------------------------------------------
[O/H] D16: Total metallicity in total region:  8.441340301149504
[O/H] PG16: Total metallicity in total region:  8.415254903001477
[O/H] O3N2-M13: Total metallicity in total region:  8.483233085272222
[O/H] N2-M13: Total metallicity in total region:  8.502159550724892
[O/H] O3N2-PP04: Total metallicity in total region:  8.655582183584631
[O/H] N2-PP04: Total metallicity in total region:  8.608838104657485
[O/H] O3N2-C20: Total metallicity in total region:  8.700117972903657
[O/H] O3S2-C20: Total metallicity in total region:  8.821051952865018
[O/H] RS32-C20: Total metallicity in total region:  8.671663282407433
[O/H] R3-C20: Total metallicity in total region:  8.69329807834641
[O/H] N2-C20: Total metallicity in total region:  8.669341793457683
[O/H] S2-C20: Total metallicity in total region:  nan
[O/H] Combined-C20: Total metallicity in total region:  8.515646837328353
--------------------------------------------------------------
Total runtime: 25.7 s
✅  NGC4330 finished in 0m27s
