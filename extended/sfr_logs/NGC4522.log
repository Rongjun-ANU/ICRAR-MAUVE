/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:267: RuntimeWarning: divide by zero encountered in divide
  BD = HA6562_FLUX / HB4861_FLUX
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:267: RuntimeWarning: invalid value encountered in divide
  BD = HA6562_FLUX / HB4861_FLUX
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:349: RuntimeWarning: divide by zero encountered in divide
  y = np.log10(NII6583_FLUX_corr / (SII6716_FLUX_corr + SII6730_FLUX_corr)) + 0.264*np.log10(NII6583_FLUX_corr / HA6562_FLUX_corr)
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:349: RuntimeWarning: divide by zero encountered in log10
  y = np.log10(NII6583_FLUX_corr / (SII6716_FLUX_corr + SII6730_FLUX_corr)) + 0.264*np.log10(NII6583_FLUX_corr / HA6562_FLUX_corr)
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:349: RuntimeWarning: invalid value encountered in divide
  y = np.log10(NII6583_FLUX_corr / (SII6716_FLUX_corr + SII6730_FLUX_corr)) + 0.264*np.log10(NII6583_FLUX_corr / HA6562_FLUX_corr)
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:360: RuntimeWarning: divide by zero encountered in divide
  N2 = NII_scaled / HB4861_FLUX_corr   # N2 = I([N II]λ6548 + λ6584)/I(Hβ)
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:360: RuntimeWarning: invalid value encountered in divide
  N2 = NII_scaled / HB4861_FLUX_corr   # N2 = I([N II]λ6548 + λ6584)/I(Hβ)
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:361: RuntimeWarning: divide by zero encountered in divide
  S2 = (SII6716_FLUX_corr + SII6730_FLUX_corr) / HB4861_FLUX_corr  # S2 = I([S II]λ6717 + λ6731)/I(Hβ)
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:361: RuntimeWarning: invalid value encountered in divide
  S2 = (SII6716_FLUX_corr + SII6730_FLUX_corr) / HB4861_FLUX_corr  # S2 = I([S II]λ6717 + λ6731)/I(Hβ)
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:362: RuntimeWarning: divide by zero encountered in divide
  R3 = OIII_scaled / HB4861_FLUX_corr  # R3 = I([O III]λ4959 + λ5007)/I(Hβ) (same value as R2 in this case)
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:362: RuntimeWarning: invalid value encountered in divide
  R3 = OIII_scaled / HB4861_FLUX_corr  # R3 = I([O III]λ4959 + λ5007)/I(Hβ) (same value as R2 in this case)
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:364: RuntimeWarning: divide by zero encountered in divide
  log_R3_S2 = np.log10(R3/S2)
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:364: RuntimeWarning: invalid value encountered in divide
  log_R3_S2 = np.log10(R3/S2)
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:364: RuntimeWarning: divide by zero encountered in log10
  log_R3_S2 = np.log10(R3/S2)
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:365: RuntimeWarning: divide by zero encountered in log10
  log_N2 = np.log10(N2)
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:366: RuntimeWarning: divide by zero encountered in log10
  log_S2 = np.log10(S2)
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:389: RuntimeWarning: invalid value encountered in add
  O_H_PG16[upper_mask] = (a1_upper + a2_upper * log_R3_S2[upper_mask] + a3_upper * log_N2[upper_mask] +
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:393: RuntimeWarning: invalid value encountered in add
  (a4_lower + a5_lower * log_R3_S2[lower_mask] + a6_lower * log_N2[lower_mask]) * log_S2[lower_mask])
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:392: RuntimeWarning: invalid value encountered in add
  O_H_PG16[lower_mask] = (a1_lower + a2_lower * log_R3_S2[lower_mask] + a3_lower * log_N2[lower_mask] +
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:408: RuntimeWarning: divide by zero encountered in divide
  oiii_hb = oiii5006_flux / hb4861_flux
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:408: RuntimeWarning: invalid value encountered in divide
  oiii_hb = oiii5006_flux / hb4861_flux
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:409: RuntimeWarning: divide by zero encountered in divide
  nii_ha = nii6583_flux / ha6562_flux
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:409: RuntimeWarning: invalid value encountered in divide
  nii_ha = nii6583_flux / ha6562_flux
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:410: RuntimeWarning: divide by zero encountered in divide
  o3n2_ratio = np.log10(oiii_hb / nii_ha)
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:410: RuntimeWarning: invalid value encountered in divide
  o3n2_ratio = np.log10(oiii_hb / nii_ha)
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:410: RuntimeWarning: divide by zero encountered in log10
  o3n2_ratio = np.log10(oiii_hb / nii_ha)
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:431: RuntimeWarning: divide by zero encountered in divide
  n2_ratio = np.log10(nii6583_flux / ha6562_flux)
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:431: RuntimeWarning: invalid value encountered in divide
  n2_ratio = np.log10(nii6583_flux / ha6562_flux)
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:431: RuntimeWarning: divide by zero encountered in log10
  n2_ratio = np.log10(nii6583_flux / ha6562_flux)
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:453: RuntimeWarning: divide by zero encountered in divide
  oiii_hb = oiii5006_flux / hb4861_flux
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:453: RuntimeWarning: invalid value encountered in divide
  oiii_hb = oiii5006_flux / hb4861_flux
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:454: RuntimeWarning: divide by zero encountered in divide
  nii_ha = nii6583_flux / ha6562_flux
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:454: RuntimeWarning: invalid value encountered in divide
  nii_ha = nii6583_flux / ha6562_flux
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:455: RuntimeWarning: divide by zero encountered in divide
  o3n2_ratio = np.log10(oiii_hb / nii_ha)
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:455: RuntimeWarning: invalid value encountered in divide
  o3n2_ratio = np.log10(oiii_hb / nii_ha)
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:455: RuntimeWarning: divide by zero encountered in log10
  o3n2_ratio = np.log10(oiii_hb / nii_ha)
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:476: RuntimeWarning: divide by zero encountered in divide
  n2_ratio = np.log10(nii6583_flux / ha6562_flux)
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:476: RuntimeWarning: invalid value encountered in divide
  n2_ratio = np.log10(nii6583_flux / ha6562_flux)
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:476: RuntimeWarning: divide by zero encountered in log10
  n2_ratio = np.log10(nii6583_flux / ha6562_flux)
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:510: RuntimeWarning: divide by zero encountered in divide
  oiii_hb = oiii5006_flux / hb4861_flux
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:510: RuntimeWarning: invalid value encountered in divide
  oiii_hb = oiii5006_flux / hb4861_flux
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:511: RuntimeWarning: divide by zero encountered in divide
  nii_ha = nii6583_flux / ha6562_flux
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:511: RuntimeWarning: invalid value encountered in divide
  nii_ha = nii6583_flux / ha6562_flux
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:512: RuntimeWarning: divide by zero encountered in divide
  o3n2_ratio = np.log10(oiii_hb / nii_ha)
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:512: RuntimeWarning: invalid value encountered in divide
  o3n2_ratio = np.log10(oiii_hb / nii_ha)
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:512: RuntimeWarning: divide by zero encountered in log10
  o3n2_ratio = np.log10(oiii_hb / nii_ha)
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:601: RuntimeWarning: divide by zero encountered in divide
  oiii_hb = oiii5006_flux / hb4861_flux
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:601: RuntimeWarning: invalid value encountered in divide
  oiii_hb = oiii5006_flux / hb4861_flux
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:604: RuntimeWarning: divide by zero encountered in divide
  sii_hb = sii_total / hb4861_flux
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:604: RuntimeWarning: invalid value encountered in divide
  sii_hb = sii_total / hb4861_flux
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:607: RuntimeWarning: divide by zero encountered in divide
  o3s2_ratio = np.log10(oiii_hb / sii_hb)
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:607: RuntimeWarning: invalid value encountered in divide
  o3s2_ratio = np.log10(oiii_hb / sii_hb)
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:607: RuntimeWarning: divide by zero encountered in log10
  o3s2_ratio = np.log10(oiii_hb / sii_hb)
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:1422: RuntimeWarning: divide by zero encountered in divide
  logN2  = np.log10(NII6583_FLUX_corr / HA6562_FLUX_corr)        # [N II]/Hα
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:1422: RuntimeWarning: invalid value encountered in divide
  logN2  = np.log10(NII6583_FLUX_corr / HA6562_FLUX_corr)        # [N II]/Hα
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:1422: RuntimeWarning: divide by zero encountered in log10
  logN2  = np.log10(NII6583_FLUX_corr / HA6562_FLUX_corr)        # [N II]/Hα
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:1423: RuntimeWarning: divide by zero encountered in divide
  logS2  = np.log10((SII6716_FLUX_corr+SII6730_FLUX_corr) / HA6562_FLUX_corr)   # Σ[S II]/Hα
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:1423: RuntimeWarning: invalid value encountered in divide
  logS2  = np.log10((SII6716_FLUX_corr+SII6730_FLUX_corr) / HA6562_FLUX_corr)   # Σ[S II]/Hα
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:1423: RuntimeWarning: divide by zero encountered in log10
  logS2  = np.log10((SII6716_FLUX_corr+SII6730_FLUX_corr) / HA6562_FLUX_corr)   # Σ[S II]/Hα
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:1424: RuntimeWarning: divide by zero encountered in divide
  logO3  = np.log10(OIII5006_FLUX_corr / HB4861_FLUX_corr)       # [O III]/Hβ
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:1424: RuntimeWarning: invalid value encountered in divide
  logO3  = np.log10(OIII5006_FLUX_corr / HB4861_FLUX_corr)       # [O III]/Hβ
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:1424: RuntimeWarning: divide by zero encountered in log10
  logO3  = np.log10(OIII5006_FLUX_corr / HB4861_FLUX_corr)       # [O III]/Hβ
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:1509: RuntimeWarning: invalid value encountered in subtract
  mask_N2_left, mask_S2_left = apply_bpt_masks(logN2=logN2-logN2_err, logS2=logS2-logS2_err, logO3=logO3)
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:1510: RuntimeWarning: invalid value encountered in add
  mask_N2_right, mask_S2_right = apply_bpt_masks(logN2=logN2+logN2_err, logS2=logS2+logS2_err, logO3=logO3)
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:1511: RuntimeWarning: invalid value encountered in subtract
  mask_N2_down, mask_S2_down = apply_bpt_masks(logN2=logN2, logS2=logS2, logO3=logO3-logO3_err)
/arc/home/RongjunHuang/ICRAR/extended/SFR+Z.py:1512: RuntimeWarning: invalid value encountered in add
  mask_N2_up, mask_S2_up = apply_bpt_masks(logN2=logN2, logS2=logS2, logO3=logO3+logO3_err)
Reading gas-line FITS ➜ /arc/projects/mauve/products/v0.6/NGC4522/NGC4522_gas_BIN_maps.fits
File not found: NGC4522_KIN_maps_extended.fits
Calculating all 6 C20 metallicities for NGC4522...
Combined C20 metallicity: median = 8.631, range = (8.202, 8.992)
Combined C20 method usage: O3N2=13094, O3S2=952, RS32=71739, R3=6662, N2=11568, S2=946
Galaxy NGC4522 inclination: 82.0° (cos θ = 0.139)
Inclination correction ENABLED: applying b/a = 0.242 (adopting intrinsic thickness q₀ = 0.2 for disc galaxy)
Combined C20 total: Selected RS32-C20 with error 0.011
Available methods: [('O3N2-C20', np.float64(8.742270894270165), np.float64(0.019991600423488565)), ('O3S2-C20', np.float64(8.840186955422597), np.float64(0.019816641440856434)), ('RS32-C20', np.float64(8.726199031629767), np.float64(0.011445618013097025)), ('R3-C20', np.float64(8.743601414667351), np.float64(0.025363745704020266)), ('N2-C20', np.float64(8.680603498254683), np.float64(0.06411880666614417))]
Combined C20 total: Selected RS32-C20 with error 0.000
Available methods: [('O3N2-C20', np.float64(8.72553597131827), np.float64(4.038276917834739e-06)), ('O3S2-C20', np.float64(8.834197275591292), np.float64(4.273133931266278e-06)), ('RS32-C20', np.float64(8.688271092177828), np.float64(3.863925638945308e-06)), ('R3-C20', np.float64(8.71360769397359), np.float64(4.870809538027912e-06)), ('N2-C20', np.float64(8.701734403958579), np.float64(5.657757722488151e-06))]
Extended file written ➜ /arc/home/RongjunHuang/ICRAR/extended/NGC4522_gas_BIN_maps_extended.fits
--------------------------------------------------------------
Total non-nan spaxels: 120510
Number of pixels with Halpha not detected: 37266
Number of pixels with Halpha detected, Hbeta not detected: 24969
Number of pixels with Halpha detected, Hbeta detected, NII not detected, OIII not detected and unclassified: 343
Number of pixels with Halpha detected, Hbeta detected, NII not detected, OIII detected and unclassified: 0
Number of pixels with Halpha detected, Hbeta detected, NII detected, OIII not detected and unclassified: 26
Number of pixels with Halpha detected, Hbeta detected, NII detected, OIII detected and unclassified: 0
Number of pixels with Halpha detected, Hbeta detected, SII not detected, OIII not detected and unclassified: 369
Number of pixels with Halpha detected, Hbeta detected, SII not detected, OIII detected and unclassified: 0
Number of pixels with Halpha detected, Hbeta detected, SII detected, OIII not detected and unclassified: 0
Number of pixels with Halpha detected, Hbeta detected, SII detected, OIII detected and unclassified: 0
--------------------------------------------------------------
Total corrected Halpha luminosity: 4.92e+40 erg/s
Total corrected Halpha luminosity from SF region: 4.67e+40 erg/s
Total Halpha SFR: 0.25 M☉/yr or in log10 scale: -0.61 log(M☉/yr)
Total Halpha SFR from SF region: 0.23 M☉/yr or in log10 scale: -0.63 log(M☉/yr)
--------------------------------------------------------------
[O/H] D16 SF: Total metallicity in SF region:  8.557179627222885
[O/H] PG16 SF: Total metallicity in SF region:  8.460048694588338
[O/H] O3N2-M13 SF: Total metallicity in SF region:  8.527493254845043
[O/H] N2-M13 SF: Total metallicity in SF region:  8.510411624772187
[O/H] O3N2-PP04 SF: Total metallicity in SF region:  8.72176561472156
[O/H] N2-PP04 SF: Total metallicity in SF region:  8.626536784662513
[O/H] O3N2-C20 SF: Total metallicity in SF region:  8.742270894270165
[O/H] O3S2-C20 SF: Total metallicity in SF region:  8.840186955422597
[O/H] RS32-C20 SF: Total metallicity in SF region:  8.726199031629767
[O/H] R3-C20 SF: Total metallicity in SF region:  8.743601414667351
[O/H] N2-C20 SF: Total metallicity in SF region:  8.680603498254683
[O/H] S2-C20 SF: Total metallicity in SF region:  nan
[O/H] Combined-C20 SF: Total metallicity in SF region:  8.726199031629767
--------------------------------------------------------------
[O/H] D16: Total metallicity in total region:  8.512690499602275
[O/H] PG16: Total metallicity in total region:  8.455337311330682
[O/H] O3N2-M13: Total metallicity in total region:  8.509715290370305
[O/H] N2-M13: Total metallicity in total region:  8.525117968079558
[O/H] O3N2-PP04: Total metallicity in total region:  8.695181742609805
[O/H] N2-PP04: Total metallicity in total region:  8.659313979536357
[O/H] O3N2-C20: Total metallicity in total region:  8.72553597131827
[O/H] O3S2-C20: Total metallicity in total region:  8.834197275591292
[O/H] RS32-C20: Total metallicity in total region:  8.688271092177828
[O/H] R3-C20: Total metallicity in total region:  8.71360769397359
[O/H] N2-C20: Total metallicity in total region:  8.701734403958579
[O/H] S2-C20: Total metallicity in total region:  nan
[O/H] Combined-C20: Total metallicity in total region:  8.688271092177828
--------------------------------------------------------------
Total runtime: 113.2 s
✅  NGC4522 finished in 2m35s
