Reading gas-line FITS ➜ NGC4694_gas_BIN_maps.fits
Loading kinematic map from NGC4694_KIN_maps_extended.fits
Filename: NGC4694_KIN_maps_extended.fits
No.    Name      Ver    Type      Cards   Dimensions   Format
  0  PRIMARY       1 PrimaryHDU       4   ()      
  1  V             1 ImageHDU        26   (439, 440)   float64   
  2  SIGMA         1 ImageHDU        26   (439, 440)   float64   
  3  H3            1 ImageHDU        26   (439, 440)   float64   
  4  H4            1 ImageHDU        26   (439, 440)   float64   
  5  FORM_ERR_V    1 ImageHDU        26   (439, 440)   float64   
  6  FORM_ERR_SIGMA    1 ImageHDU        26   (439, 440)   float64   
  7  FORM_ERR_H3    1 ImageHDU        26   (439, 440)   float64   
  8  FORM_ERR_H4    1 ImageHDU        26   (439, 440)   float64   
  9  SNR_POSTFIT    1 ImageHDU        26   (439, 440)   float64   
 10  FOREGROUND_STAR    1 ImageHDU        26   (439, 440)   float32   
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:248: RuntimeWarning: divide by zero encountered in divide
  BD = HA6562_FLUX / HB4861_FLUX
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:309: RuntimeWarning: divide by zero encountered in divide
  y = np.log10(NII6583_FLUX_corr / (SII6716_FLUX_corr + SII6730_FLUX_corr)) + 0.264*np.log10(NII6583_FLUX_corr / HA6562_FLUX_corr)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:309: RuntimeWarning: divide by zero encountered in log10
  y = np.log10(NII6583_FLUX_corr / (SII6716_FLUX_corr + SII6730_FLUX_corr)) + 0.264*np.log10(NII6583_FLUX_corr / HA6562_FLUX_corr)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:320: RuntimeWarning: divide by zero encountered in divide
  N2 = NII_scaled / HB4861_FLUX_corr   # N2 = I([N II]λ6548 + λ6584)/I(Hβ)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:321: RuntimeWarning: divide by zero encountered in divide
  S2 = (SII6716_FLUX_corr + SII6730_FLUX_corr) / HB4861_FLUX_corr  # S2 = I([S II]λ6717 + λ6731)/I(Hβ)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:322: RuntimeWarning: divide by zero encountered in divide
  R3 = OIII_scaled / HB4861_FLUX_corr  # R3 = I([O III]λ4959 + λ5007)/I(Hβ) (same value as R2 in this case)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:322: RuntimeWarning: invalid value encountered in divide
  R3 = OIII_scaled / HB4861_FLUX_corr  # R3 = I([O III]λ4959 + λ5007)/I(Hβ) (same value as R2 in this case)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:324: RuntimeWarning: divide by zero encountered in divide
  log_R3_S2 = np.log10(R3/S2)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:324: RuntimeWarning: invalid value encountered in divide
  log_R3_S2 = np.log10(R3/S2)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:324: RuntimeWarning: divide by zero encountered in log10
  log_R3_S2 = np.log10(R3/S2)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:325: RuntimeWarning: divide by zero encountered in log10
  log_N2 = np.log10(N2)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:326: RuntimeWarning: divide by zero encountered in log10
  log_S2 = np.log10(S2)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:349: RuntimeWarning: invalid value encountered in add
  O_H_PG16[upper_mask] = (a1_upper + a2_upper * log_R3_S2[upper_mask] + a3_upper * log_N2[upper_mask] +
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:375: RuntimeWarning: divide by zero encountered in divide
  oiii_hb = oiii5006_flux / hb4861_flux
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:375: RuntimeWarning: invalid value encountered in divide
  oiii_hb = oiii5006_flux / hb4861_flux
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:377: RuntimeWarning: divide by zero encountered in divide
  o3n2_ratio = np.log10(oiii_hb / nii_ha)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:377: RuntimeWarning: divide by zero encountered in log10
  o3n2_ratio = np.log10(oiii_hb / nii_ha)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:405: RuntimeWarning: divide by zero encountered in log10
  n2_ratio = np.log10(nii6583_flux / ha6562_flux)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:434: RuntimeWarning: divide by zero encountered in divide
  oiii_hb = oiii5006_flux / hb4861_flux
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:434: RuntimeWarning: invalid value encountered in divide
  oiii_hb = oiii5006_flux / hb4861_flux
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:436: RuntimeWarning: divide by zero encountered in divide
  o3n2_ratio = np.log10(oiii_hb / nii_ha)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:436: RuntimeWarning: divide by zero encountered in log10
  o3n2_ratio = np.log10(oiii_hb / nii_ha)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:464: RuntimeWarning: divide by zero encountered in log10
  n2_ratio = np.log10(nii6583_flux / ha6562_flux)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:488: RuntimeWarning: divide by zero encountered in divide
  oiii_hb = oiii5006_flux / hb4861_flux
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:488: RuntimeWarning: invalid value encountered in divide
  oiii_hb = oiii5006_flux / hb4861_flux
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:490: RuntimeWarning: divide by zero encountered in divide
  o3n2_ratio = np.log10(oiii_hb / nii_ha)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:490: RuntimeWarning: divide by zero encountered in log10
  o3n2_ratio = np.log10(oiii_hb / nii_ha)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:547: RuntimeWarning: divide by zero encountered in divide
  oiii_hb = oiii5006_flux / hb4861_flux
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:547: RuntimeWarning: invalid value encountered in divide
  oiii_hb = oiii5006_flux / hb4861_flux
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:549: RuntimeWarning: divide by zero encountered in divide
  o3s2_ratio = np.log10(oiii_hb / (sii_total / hb4861_flux))  # ([OIII]/Hβ) / ([SII]/Hβ)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:549: RuntimeWarning: invalid value encountered in divide
  o3s2_ratio = np.log10(oiii_hb / (sii_total / hb4861_flux))  # ([OIII]/Hβ) / ([SII]/Hβ)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:549: RuntimeWarning: divide by zero encountered in log10
  o3s2_ratio = np.log10(oiii_hb / (sii_total / hb4861_flux))  # ([OIII]/Hβ) / ([SII]/Hβ)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:1077: RuntimeWarning: divide by zero encountered in log10
  logN2  = np.log10(NII6583_FLUX_corr / HA6562_FLUX_corr)        # [N II]/Hα
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:1078: RuntimeWarning: divide by zero encountered in log10
  logS2  = np.log10((SII6716_FLUX_corr+SII6730_FLUX_corr) / HA6562_FLUX_corr)   # Σ[S II]/Hα
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:1079: RuntimeWarning: divide by zero encountered in divide
  logO3  = np.log10(OIII5006_FLUX_corr / HB4861_FLUX_corr)       # [O III]/Hβ
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:1079: RuntimeWarning: invalid value encountered in divide
  logO3  = np.log10(OIII5006_FLUX_corr / HB4861_FLUX_corr)       # [O III]/Hβ
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:1079: RuntimeWarning: divide by zero encountered in log10
  logO3  = np.log10(OIII5006_FLUX_corr / HB4861_FLUX_corr)       # [O III]/Hβ
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:1165: RuntimeWarning: invalid value encountered in add
  mask_N2_right, mask_S2_right = apply_bpt_masks(logN2=logN2+logN2_err, logS2=logS2+logS2_err, logO3=logO3)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:1166: RuntimeWarning: invalid value encountered in subtract
  mask_N2_down, mask_S2_down = apply_bpt_masks(logN2=logN2, logS2=logS2, logO3=logO3-logO3_err)
/Users/Igniz/Desktop/ICRAR/extended/SFR+Z.py:1167: RuntimeWarning: invalid value encountered in add
  mask_N2_up, mask_S2_up = apply_bpt_masks(logN2=logN2, logS2=logS2, logO3=logO3+logO3_err)
Available extensions: ['V', 'SIGMA', 'H3', 'H4', 'FORM_ERR_V', 'FORM_ERR_SIGMA', 'FORM_ERR_H3', 'FORM_ERR_H4', 'SNR_POSTFIT', 'FOREGROUND_STAR']
Loaded V: shape (440, 439)
Loaded SIGMA: shape (440, 439)
Loaded H3: shape (440, 439)
Loaded H4: shape (440, 439)
Loaded FORM_ERR_V: shape (440, 439)
Loaded FORM_ERR_SIGMA: shape (440, 439)
Loaded FORM_ERR_H3: shape (440, 439)
Loaded FORM_ERR_H4: shape (440, 439)
Loaded SNR_POSTFIT: shape (440, 439)
Loaded FOREGROUND_STAR: shape (440, 439)
All data loaded successfully!
Foreground stars are removed successfully!
Combined C20 metallicity: median = 8.687, range = (8.052, 9.156)
Combined C20 method usage: O3N2=79623, N2=121, O3S2=6, S2=0, RS32=0, R3=0
Galaxy NGC4694 inclination: 62.0° (cos θ = 0.469)
Combined C20 total: Selected O3N2-C20 with error 0.100
Available methods: [('O3N2-C20', np.float64(8.593886823451806), 0.1), ('O3S2-C20', np.float64(8.693205782551882), 0.15), ('RS32-C20', np.float64(8.658889902227635), 0.2), ('R3-C20', np.float64(8.564741037368952), 0.25), ('N2-C20', np.float64(8.510622268214783), 0.12), ('S2-C20', np.float64(8.538254424131317), 0.18)]
Combined C20 total: Selected O3N2-C20 with error 0.100
Available methods: [('O3N2-C20', np.float64(8.512355558407904), 0.1), ('O3S2-C20', np.float64(8.722213695280827), 0.15), ('RS32-C20', np.float64(8.722513624676582), 0.2), ('R3-C20', np.float64(8.660640240855031), 0.25), ('N2-C20', np.float64(8.554824112641011), 0.12), ('S2-C20', np.float64(8.599372980922755), 0.18)]
Extended file written ➜ /Users/Igniz/Desktop/ICRAR/extended/NGC4694_gas_BIN_maps_extended.fits
--------------------------------------------------------------
Total non-nan spaxels: 81435
Number of pixels with Halpha not detected: 11652
Number of pixels with Halpha detected, Hbeta not detected: 41067
Number of pixels with Halpha detected, Hbeta detected, NII not detected, OIII not detected and unclassified: 8
Number of pixels with Halpha detected, Hbeta detected, NII not detected, OIII detected and unclassified: 6
Number of pixels with Halpha detected, Hbeta detected, NII detected, OIII not detected and unclassified: 161
Number of pixels with Halpha detected, Hbeta detected, NII detected, OIII detected and unclassified: 3780
Number of pixels with Halpha detected, Hbeta detected, SII not detected, OIII not detected and unclassified: 80
Number of pixels with Halpha detected, Hbeta detected, SII not detected, OIII detected and unclassified: 460
Number of pixels with Halpha detected, Hbeta detected, SII detected, OIII not detected and unclassified: 89
Number of pixels with Halpha detected, Hbeta detected, SII detected, OIII detected and unclassified: 3326
--------------------------------------------------------------
Total corrected Halpha luminosity: 2.01e+40 erg/s
Total corrected Halpha luminosity from SF region: 1.52e+40 erg/s
Total Halpha SFR: 0.10 M☉/yr or in log10 scale: -1.00 log(M☉/yr)
Total Halpha SFR from SF region: 0.08 M☉/yr or in log10 scale: -1.12 log(M☉/yr)
--------------------------------------------------------------
[O/H] D16 SF: Total metallicity in SF region:  8.636783127740172
[O/H] PG16 SF: Total metallicity in SF region:  8.508139081711215
[O/H] O3N2-M13 SF: Total metallicity in SF region:  8.52638430683839
[O/H] N2-M13 SF: Total metallicity in SF region:  8.535818719788075
[O/H] O3N2-PP04 SF: Total metallicity in SF region:  8.720107374711612
[O/H] N2-PP04 SF: Total metallicity in SF region:  8.684188308210024
[O/H] O3N2-C20 SF: Total metallicity in SF region:  8.741234442462854
[O/H] O3S2-C20 SF: Total metallicity in SF region:  8.8261546699739
[O/H] RS32-C20 SF: Total metallicity in SF region:  8.717099530694785
[O/H] R3-C20 SF: Total metallicity in SF region:  8.728111257918997
[O/H] N2-C20 SF: Total metallicity in SF region:  8.718229960780546
[O/H] S2-C20 SF: Total metallicity in SF region:  nan
[O/H] Combined-C20 SF: Total metallicity in SF region:  8.593886823451806
--------------------------------------------------------------
[O/H] D16: Total metallicity in total region:  8.60179641898232
[O/H] PG16: Total metallicity in total region:  8.552811952239308
[O/H] O3N2-M13: Total metallicity in total region:  8.481624195119686
[O/H] N2-M13: Total metallicity in total region:  8.58687185010037
[O/H] O3N2-PP04: Total metallicity in total region:  8.65317636653411
[O/H] N2-PP04: Total metallicity in total region:  8.815528449893938
[O/H] O3N2-C20: Total metallicity in total region:  8.698554079891235
[O/H] O3S2-C20: Total metallicity in total region:  8.796607601832827
[O/H] RS32-C20: Total metallicity in total region:  8.613123890640967
[O/H] R3-C20: Total metallicity in total region:  8.636690167483726
[O/H] N2-C20: Total metallicity in total region:  8.842645095391834
[O/H] S2-C20: Total metallicity in total region:  nan
[O/H] Combined-C20: Total metallicity in total region:  8.512355558407904
--------------------------------------------------------------
Total runtime: 16.8 s
✅  NGC4694 finished in 0m23s
